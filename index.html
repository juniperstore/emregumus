<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Emre GÃ¼mÃ¼ÅŸ | Gold Tracker Pro v7.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    :root { 
        --gold: #D4AF37; --bg: #000; --card-bg: #111; --text: #e0e0e0; 
        --radius: 12px; --danger: #ff4d4d; --success: #2ecc71; 
        --input-bg: #151515; --info: #3498db; 
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
    body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

    /* GiriÅŸ EkranÄ± */
    #loginScreen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .premium-input { 
        width: 100%; padding: 15px; background: var(--input-bg); border: 1px solid #333; 
        border-radius: 10px; color: #fff; font-size: 1.1em; margin-bottom: 12px; 
        transition: all 0.3s ease; text-align: center; 
    }
    .premium-input:focus { border-color: var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.2); }
    
    header { background: #000; padding: 12px; text-align: center; border-bottom: 1px solid #222; color: var(--gold); font-weight: 700; font-size: 1.1em; letter-spacing: 2px; }
    nav { display: flex; background: #000; border-bottom: 1px solid #222; }
    nav button { flex: 1; padding: 15px 0; border: none; background: transparent; color: #666; font-weight: 700; cursor: pointer; font-size: 0.8em; }
    nav button.active { color: var(--gold); border-bottom: 3px solid var(--gold); }

    main { flex: 1; overflow-y: auto; padding: 10px; -webkit-overflow-scrolling: touch; }
    section { display: none; width: 100%; max-width: 1000px; margin: 0 auto; }
    section.active { display: block; animation: fadeIn 0.2s ease; }

    /* Hesap Makinesi DÃ¼zeni */
    .calc-layout { display: flex; gap: 15px; align-items: flex-start; }
    .left-side { flex: 2; display: flex; flex-direction: column; gap: 10px; }
    .right-side { flex: 1; min-width: 220px; }

    .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    .numpad button { background: #1a1a1a; border: 1px solid #333; color: white; padding: 22px 10px; border-radius: 10px; font-size: 1.5em; font-weight: bold; cursor: pointer; }
    .numpad button:active { background: var(--gold); color: black; }
    
    input#gram { width: 100%; padding: 20px; background: #111; border: 2px solid #333; border-radius: var(--radius); color: var(--gold); font-size: 2.2em; text-align: center; font-weight: bold; margin-bottom: 5px; }
    
    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    .card { background: var(--card-bg); border-radius: var(--radius); padding: 20px 10px; text-align: center; border: 1px solid #252525; cursor: pointer; transition: 0.2s; }
    .card:active { transform: scale(0.95); }
    .card b { display: block; color: var(--gold); font-size: 1.1em; }

    .list-item { background: #111; padding: 12px; border-radius: 10px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #222; }
    .btn-action { border: none; padding: 8px 12px; border-radius: 6px; font-weight: bold; cursor: pointer; }
    .btn-main { background: var(--gold); color: #000; padding: 15px; border-radius: 10px; width: 100%; font-weight: 700; cursor: pointer; margin-bottom: 10px; border:none; }
    
    .result-bar { background: #000; padding: 15px 25px; border-top: 2px solid var(--gold); display: flex; justify-content: space-between; align-items: center; }

    @media (max-width: 600px) { .calc-layout { flex-direction: column; } .right-side { width: 100%; order: -1; } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body>

<div id="loginScreen">
    <div style="width: 100%; max-width: 320px; text-align: center;">
        <h2 style="color:var(--gold); letter-spacing: 4px; margin-bottom:30px;">EMRE GÃœMÃœÅž</h2>
        <input type="password" id="passInput" class="premium-input" placeholder="SÄ°STEM ÅžÄ°FRESÄ°" autofocus>
        <button class="btn-main" onclick="checkLogin()">GÄ°RÄ°Åž YAP</button>
    </div>
</div>

<div id="app" style="display:none; flex-direction: column; height: 100vh;">
    <header>EMRE GÃœMÃœÅž</header>
    <nav>
        <button id="btn-hesap" class="active" onclick="openTab('hesap',this)">HESAP</button>
        <button id="btn-rapor" onclick="openTab('rapor',this)">ARÅžÄ°V</button>
        <button id="btn-ayar" onclick="openTab('ayar',this)">AYARLAR</button>
    </nav>

    <main>
        <section id="hesap" class="active">
            <div class="calc-layout">
                <div class="left-side">
                    <input type="text" id="gram" placeholder="0.00" readonly>
                    <div class="grid" id="urunler"></div>
                </div>
                <div class="right-side">
                    <div class="numpad">
                        <button onclick="numIn('1')">1</button><button onclick="numIn('2')">2</button><button onclick="numIn('3')">3</button>
                        <button onclick="numIn('4')">4</button><button onclick="numIn('5')">5</button><button onclick="numIn('6')">6</button>
                        <button onclick="numIn('7')">7</button><button onclick="numIn('8')">8</button><button onclick="numIn('9')">9</button>
                        <button onclick="numIn('.')">,</button><button onclick="numIn('0')">0</button><button style="color:var(--danger)" onclick="numIn('C')">C</button>
                    </div>
                </div>
            </div>
            <h4 style="color:var(--danger); margin:20px 0 10px">BEKLEYEN Ä°ÅžLEMLER</h4>
            <div id="bekleyen"></div>
        </section>

        <section id="rapor">
            <div style="background:#111; padding:15px; border-radius:10px; margin-bottom:15px; border:1px solid #222; height: 220px;">
                <canvas id="ciroChart"></canvas>
            </div>
            <button class="btn-main" onclick="gunSonu()">ðŸ“… GÃœNÃœ KAPAT VE RAPORLA</button>
            <div id="arsivList"></div>
        </section>

        <section id="ayar">
            <div style="background:var(--card-bg); padding:15px; border-radius:var(--radius); margin-bottom:20px; border: 1px solid var(--info)">
                <h4 style="margin-top:0; color:var(--info)">WHATSAPP RAPOR AYARI</h4>
                <input id="wpTel" class="premium-input" placeholder="905XXXXXXXXX" onchange="saveWp()">
                <small style="color:#666; display:block; text-align:center">Raporun gideceÄŸi numarayÄ± yaz kanka.</small>
            </div>

            <div style="background:var(--card-bg); padding:20px; border-radius:var(--radius); border: 1px solid #333">
                <h4 id="ayarTitle" style="margin-top:0; color:var(--gold)">ÃœRÃœN YÃ–NETÄ°MÄ°</h4>
                <input id="urunAd" class="premium-input" placeholder="ÃœrÃ¼n Ä°smi">
                <input id="urunFiyat" type="number" class="premium-input" placeholder="Gram FiyatÄ± (â‚º)">
                <button id="saveBtn" class="btn-main" onclick="urunEkle()">KAYDET</button>
                <button id="cancelEdit" class="btn-action" style="display:none; width:100%; background:#222; color:#888" onclick="resetEdit()">VAZGEÃ‡</button>
            </div>
            
            <h4 style="color:var(--gold); margin-top:20px">MEVCUT ÃœRÃœNLER</h4>
            <div id="ayarList"></div>
        </section>
    </main>

    <div class="result-bar">
        <span style="font-weight:bold; color:#666">HESAP:</span>
        <b id="sonuc" style="font-size:1.8em; color:var(--gold)">0,00 â‚º</b>
    </div>
</div>

<script>
let urunler = JSON.parse(localStorage.getItem("urunler")) || [{ad:"22 Ayar", fiyat:2450}];
let kayitlar = JSON.parse(localStorage.getItem("kayitlar")) || [];
let editIndex = -1;
let myChart = null;

function checkLogin() {
    const sysPass = localStorage.getItem("password") || "1234";
    if(document.getElementById("passInput").value === sysPass) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("app").style.display = "flex";
        renderUrunler();
        loadWp();
    } else { alert("Åžifre YanlÄ±ÅŸ!"); }
}

function numIn(val) {
    let inp = document.getElementById("gram");
    if(val === 'C') { inp.value = ""; return; }
    if(val === '.' && inp.value.includes('.')) return;
    inp.value += val;
}

function openTab(id,btn){
    document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    btn.classList.add("active");
    if(id === 'rapor') { renderArsiv(); renderChart(); }
    if(id === 'ayar') renderAyar();
}

function renderUrunler(){
    document.getElementById("urunler").innerHTML = urunler.map((u,i)=>`
        <div class="card" onclick="hesapla(${i})"><b>${u.ad}</b><small>${u.fiyat} â‚º</small></div>
    `).join('');
}

function hesapla(i){
    let g = parseFloat(document.getElementById("gram").value);
    if(!g) return;
    let tutar = g * urunler[i].fiyat;
    document.getElementById("sonuc").innerText = formatPara(tutar) + " â‚º";
    kayitlar.push({id: Date.now(), urun:urunler[i].ad, gram:g, tutar:tutar, satildi:false});
    document.getElementById("gram").value = ""; 
    save(); renderRapor();
}

function renderRapor(){
    document.getElementById("bekleyen").innerHTML = kayitlar.filter(k=>!k.satildi).map(k=>`
        <div class="list-item">
            <div><strong>${k.urun}</strong><br><small>${k.gram} gr - ${formatPara(k.tutar)} â‚º</small></div>
            <div>
                <button class="btn-action" style="background:var(--success)" onclick="islemYap(${k.id}, 'sat')">SAT</button>
                <button class="btn-action" style="background:var(--danger); color:white" onclick="islemYap(${k.id}, 'sil')">X</button>
            </div>
        </div>`).join('');
}

function islemYap(id, tip){
    let idx = kayitlar.findIndex(k=>k.id === id);
    if(tip === 'sat') kayitlar[idx].satildi = true;
    else if(confirm("Ä°ÅŸlem silinsin mi?")) kayitlar.splice(idx, 1);
    save(); renderRapor();
}

function renderAyar(){
    document.getElementById("ayarList").innerHTML = urunler.map((u,i)=>`
        <div class="list-item">
            <div><strong>${u.ad}</strong><br><small>${u.fiyat} â‚º</small></div>
            <div style="display:flex; gap:5px">
                <button class="btn-action" style="background:var(--info); color:white" onclick="editMode(${i})">DÃœZENLE</button>
                <button class="btn-action" style="background:var(--danger); color:white" onclick="urunSil(${i})">SÄ°L</button>
            </div>
        </div>`).join('');
}

function editMode(i) {
    editIndex = i;
    document.getElementById("urunAd").value = urunler[i].ad;
    document.getElementById("urunFiyat").value = urunler[i].fiyat;
    document.getElementById("ayarTitle").innerText = "ÃœRÃœNÃœ GÃœNCELLE";
    document.getElementById("saveBtn").innerText = "GÃœNCELLE";
    document.getElementById("cancelEdit").style.display = "block";
}

function resetEdit() {
    editIndex = -1;
    document.getElementById("urunAd").value = "";
    document.getElementById("urunFiyat").value = "";
    document.getElementById("ayarTitle").innerText = "ÃœRÃœN YÃ–NETÄ°MÄ°";
    document.getElementById("saveBtn").innerText = "KAYDET";
    document.getElementById("cancelEdit").style.display = "none";
}

function urunEkle(){
    let ad = document.getElementById("urunAd").value, f = parseFloat(document.getElementById("urunFiyat").value);
    if(!ad || !f) return;
    if(editIndex > -1) urunler[editIndex] = {ad, fiyat:f};
    else urunler.push({ad, fiyat:f});
    save(); renderUrunler(); renderAyar(); resetEdit();
}

function urunSil(i){ if(confirm("Silinsin mi?")){ urunler.splice(i, 1); save(); renderAyar(); renderUrunler(); } }

function saveWp() { localStorage.setItem("wpTel", document.getElementById("wpTel").value); }
function loadWp() { document.getElementById("wpTel").value = localStorage.getItem("wpTel") || ""; }

function gunSonu(){
    let satilanlar = kayitlar.filter(x=>x.satildi);
    if(!satilanlar.length) return alert("SatÄ±ÅŸ yok!");
    
    let d = new Date(), t = d.toLocaleDateString('tr-TR'), ciro = satilanlar.reduce((s,i)=>s+i.tutar, 0);
    
    // ArÅŸivle
    let key = "arsiv_" + d.getFullYear() + String(d.getMonth()+1).padStart(2,'0') + String(d.getDate()).padStart(2,'0') + "_" + d.getTime();
    localStorage.setItem(key, JSON.stringify({ label: t, data: satilanlar }));

    // WP Mesaj
    let msg = `ðŸ“± *EMRE GÃœMÃœÅž GÃœN SONU*\nðŸ“… *Tarih:* ${t}\nðŸ’° *Ciro:* ${formatPara(ciro)} â‚º\n------------------\n`;
    satilanlar.forEach(s=> msg += `- ${s.urun}: ${s.gram}gr\n`);
    
    let tel = localStorage.getItem("wpTel");
    if(tel && confirm("Rapor WhatsApp ile gÃ¶nderilsin mi?")) window.open(`https://api.whatsapp.com/send?phone=${tel}&text=${encodeURIComponent(msg)}`, '_blank');

    kayitlar = kayitlar.filter(x=>!x.satildi);
    save(); renderRapor(); renderArsiv(); renderChart();
}

function renderChart() {
    const ctx = document.getElementById('ciroChart').getContext('2d');
    const keys = Object.keys(localStorage).filter(k=>k.startsWith("arsiv_")).sort().slice(-7);
    let labels = [], data = [];
    keys.forEach(k => {
        let obj = JSON.parse(localStorage.getItem(k));
        labels.push(obj.label);
        data.push((obj.data || []).reduce((s, i) => s + i.tutar, 0));
    });
    if(myChart) myChart.destroy();
    myChart = new Chart(ctx, { type: 'bar', data: { labels, datasets: [{ label: 'Ciro', data, backgroundColor: '#D4AF37' }] }, options: { responsive: true, maintainAspectRatio: false } });
}

function renderArsiv(){
    const keys = Object.keys(localStorage).filter(k=>k.startsWith("arsiv_")).sort().reverse();
    document.getElementById("arsivList").innerHTML = keys.map(k=> {
        let obj = JSON.parse(localStorage.getItem(k));
        return `<div class="list-item"><span>ðŸ“‚ ${obj.label}</span><button class="btn-action" style="background:var(--danger); color:white" onclick="localStorage.removeItem('${k}');renderArsiv();">SÄ°L</button></div>`;
    }).join('');
}

function save(){ localStorage.setItem("kayitlar", JSON.stringify(kayitlar)); localStorage.setItem("urunler", JSON.stringify(urunler)); }
function formatPara(n){ return n.toLocaleString('tr-TR',{minimumFractionDigits:2}); }
</script>
</body>
</html>
