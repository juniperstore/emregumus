<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Emre G√ºm√º≈ü | Gold Tracker Pro v7.8</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    :root { 
        --gold: #D4AF37; --bg: #0c0c0c; --card-bg: #1a1a1a; --text: #e0e0e0; 
        --radius: 16px; --danger: #ff4d4d; --success: #2ecc71; 
        --input-bg: #151515; --info: #3498db; 
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
    body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; }

    /* Giri≈ü */
    #loginScreen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .premium-input { width: 100%; padding: 18px; background: #111; border: 1px solid #333; border-radius: 12px; color: #fff; font-size: 1.1em; margin-bottom: 12px; text-align: center; }
    
    header { background: #000; padding: 15px; text-align: center; border-bottom: 1px solid #222; color: var(--gold); font-weight: 700; font-size: 1.2em; letter-spacing: 3px; }
    nav { display: flex; background: #111; border-bottom: 1px solid #222; }
    nav button { flex: 1; padding: 18px 0; border: none; background: transparent; color: #666; font-weight: 700; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    nav button.active { color: var(--gold); border-bottom: 3px solid var(--gold); background: rgba(212,175,55,0.05); }

    main { flex: 1; overflow: hidden; display: flex; flex-direction: column; }
    section { display: none; height: 100%; width: 100%; max-width: 1400px; margin: 0 auto; padding: 20px; }
    section.active { display: flex; flex-direction: column; animation: fadeIn 0.3s ease; }

    .calc-layout { display: flex; gap: 25px; height: 100%; }
    
    /* Sol Taraf: √úr√ºnler */
    .left-side { flex: 1.6; display: flex; flex-direction: column; }
    #gram { width: 100%; padding: 20px; background: #000; border: 1px solid #333; border-radius: 14px; color: var(--gold); font-size: 2.8em; text-align: center; font-weight: bold; margin-bottom: 20px; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5); }
    
    .scroll-area { flex: 1; overflow-y: auto; padding-right: 10px; }
    .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    
    /* √úr√ºn Kartƒ± Tasarƒ±mƒ± */
    .card { 
        background: var(--card-bg); border-radius: var(--radius); padding: 25px 20px; 
        text-align: left; border: 1px solid #333; cursor: pointer; transition: 0.2s;
        display: flex; flex-direction: column; justify-content: center; gap: 8px;
    }
    .card:active { transform: scale(0.97); background: #222; border-color: var(--gold); }
    .card b { color: #fff; font-size: 1.2em; display: block; }
    .card span { color: #888; font-size: 0.95em; }

    /* Saƒü Taraf: Numpad ve Sonu√ß */
    .right-side { flex: 1; min-width: 320px; display: flex; flex-direction: column; gap: 20px; }
    .numpad-box { background: #111; padding: 20px; border-radius: var(--radius); border: 1px solid #222; }
    .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
    .numpad button { background: #222; border: 1px solid #333; color: white; padding: 22px 5px; border-radius: 12px; font-size: 1.6em; font-weight: bold; cursor: pointer; transition: 0.2s; }
    .numpad button:active { background: var(--gold); color: black; }
    
    /* Sticky Result Harmanlanmƒ±≈ü */
    .sticky-result { background: #111; border: 1px solid var(--gold); border-radius: var(--radius); padding: 25px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    .sticky-result small { color: #888; font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; }
    .sticky-result b { font-size: 2.4em; color: var(--gold); display: block; margin-top: 10px; }

    /* Premium List Item (SAT/Sƒ∞L) */
    .list-item { background: #1a1a1a; padding: 18px; border-radius: 14px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--gold); }
    .btn-sat { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; border: none; padding: 10px 25px; border-radius: 50px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3); }
    .btn-sil { background: transparent; color: #ff4d4d; border: 1.5px solid #ff4d4d; padding: 8px 18px; border-radius: 50px; font-weight: 700; cursor: pointer; margin-left: 8px; }

    .btn-main { background: var(--gold); color: #000; padding: 18px; border-radius: 12px; width: 100%; font-weight: 700; border:none; cursor: pointer; font-size: 1.1em; transition: 0.3s; }
    .btn-main:active { transform: scale(0.98); }

    @media (max-width: 900px) {
        .calc-layout { flex-direction: column; overflow-y: auto; }
        .right-side { min-width: 100%; }
        body { overflow: auto; }
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div id="loginScreen">
    <div style="width: 100%; max-width: 320px; text-align: center;">
        <h2 style="color:var(--gold); letter-spacing: 5px; margin-bottom:40px;">EMRE G√úM√ú≈û</h2>
        <input type="password" id="passInput" class="premium-input" placeholder="Giri≈ü ≈ûifresi" autofocus>
        <button class="btn-main" onclick="checkLogin()">PANELE Gƒ∞Rƒ∞≈û</button>
    </div>
</div>

<div id="app" style="display:none; flex-direction: column; height: 100vh;">
    <header>EMRE G√úM√ú≈û | GOLD TRACKER</header>
    <nav>
        <button id="btn-hesap" class="active" onclick="openTab('hesap',this)">HESAPLAMA</button>
        <button id="btn-rapor" onclick="openTab('rapor',this)">AR≈ûƒ∞V & ANALƒ∞Z</button>
        <button id="btn-ayar" onclick="openTab('ayar',this)">AYARLAR</button>
    </nav>

    <main>
        <section id="hesap" class="active">
            <div class="calc-layout">
                <div class="left-side">
                    <input type="text" id="gram" placeholder="0.00" readonly>
                    <div class="scroll-area">
                        <div class="grid" id="urunler"></div>
                        <h4 style="color:var(--gold); margin:30px 0 15px; letter-spacing: 1px;">BEKLEYEN ƒ∞≈ûLEMLER</h4>
                        <div id="bekleyen"></div>
                    </div>
                </div>

                <div class="right-side">
                    <div class="numpad-box">
                        <div class="numpad">
                            <button onclick="numIn('1')">1</button><button onclick="numIn('2')">2</button><button onclick="numIn('3')">3</button>
                            <button onclick="numIn('4')">4</button><button onclick="numIn('5')">5</button><button onclick="numIn('6')">6</button>
                            <button onclick="numIn('7')">7</button><button onclick="numIn('8')">8</button><button onclick="numIn('9')">9</button>
                            <button onclick="numIn('.')">,</button><button onclick="numIn('0')">0</button><button style="color:var(--danger)" onclick="numIn('C')">C</button>
                            <button style="grid-column: span 3; color:var(--info); font-size: 1em;" onclick="numIn('B')">‚Üê GERƒ∞ Sƒ∞L</button>
                        </div>
                    </div>
                    
                    <div class="sticky-result">
                        <small>Hesaplanan Tutar</small>
                        <b id="sonuc">0,00 ‚Ç∫</b>
                    </div>
                </div>
            </div>
        </section>

        <section id="rapor">
            <div style="background:#111; padding:20px; border-radius:14px; margin-bottom:20px; border:1px solid #222; height: 250px;">
                <canvas id="ciroChart"></canvas>
            </div>
            <div class="scroll-area">
                <button class="btn-main" onclick="gunSonu()" style="margin-bottom:20px; background: var(--success); color: #fff;">üìÖ G√úN√ú KAPAT VE RAPORLA</button>
                <div id="arsivList"></div>
            </div>
        </section>

        <section id="ayar">
            <div class="scroll-area">
                <div style="background:var(--card-bg); padding:25px; border-radius:var(--radius); margin-bottom:20px; border: 1px solid #333">
                    <h4 style="margin-top:0; color:var(--info)">WHATSAPP RAPOR NUMARASI</h4>
                    <input id="wpTel" class="premium-input" placeholder="905XXXXXXXXX" onchange="saveWp()">
                </div>
                <div style="background:var(--card-bg); padding:25px; border-radius:var(--radius); border: 1px solid #333">
                    <h4 id="ayarTitle" style="margin-top:0; color:var(--gold)">√úR√úN EKLE / D√úZENLE</h4>
                    <input id="urunAd" class="premium-input" placeholder="√úr√ºn ƒ∞smi (√ñrn: 22 Ayar)">
                    <input id="urunFiyat" type="number" class="premium-input" placeholder="Gram Fiyatƒ± (‚Ç∫)">
                    <button id="saveBtn" class="btn-main" onclick="urunEkle()">Sƒ∞STEME KAYDET</button>
                    <button id="cancelEdit" class="btn-sil" style="display:none; width:100%; margin-top:15px; padding:15px;" onclick="resetEdit()">VAZGE√á</button>
                </div>
                <h4 style="color:var(--gold); margin-top:30px">KAYITLI √úR√úNLER</h4>
                <div id="ayarList"></div>
            </div>
        </section>
    </main>
</div>

<script>
let urunler = JSON.parse(localStorage.getItem("urunler")) || [{ad:"22 Ayar", fiyat:2450}, {ad:"14 Ayar", fiyat:1650}];
let kayitlar = JSON.parse(localStorage.getItem("kayitlar")) || [];
let editIndex = -1;
let myChart = null;

function checkLogin() {
    const sysPass = localStorage.getItem("password") || "1234";
    if(document.getElementById("passInput").value === sysPass) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("app").style.display = "flex";
        renderUrunler(); renderRapor(); loadWp();
    } else { alert("Hatalƒ± ≈ûifre!"); }
}

function numIn(val) {
    let inp = document.getElementById("gram");
    if(val === 'C') { inp.value = ""; return; }
    if(val === 'B') { inp.value = inp.value.slice(0, -1); return; }
    if(val === '.' && inp.value.includes('.')) return;
    if(inp.value.length < 10) inp.value += val;
}

function openTab(id,btn){
    document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    btn.classList.add("active");
    if(id === 'rapor') { renderArsiv(); renderChart(); }
    if(id === 'ayar') renderAyar();
}

function renderUrunler(){
    document.getElementById("urunler").innerHTML = urunler.map((u,i)=>`
        <div class="card" onclick="hesapla(${i})">
            <b>${u.ad}</b>
            <span>${u.fiyat} ‚Ç∫/gr</span>
        </div>
    `).join('');
}

function hesapla(i){
    let g = parseFloat(document.getElementById("gram").value);
    if(!g) return;
    let tutar = g * urunler[i].fiyat;
    document.getElementById("sonuc").innerText = formatPara(tutar) + " ‚Ç∫";
    kayitlar.push({id: Date.now(), urun:urunler[i].ad, gram:g, tutar:tutar, satildi:false});
    document.getElementById("gram").value = ""; 
    save(); renderRapor();
}

function renderRapor(){
    document.getElementById("bekleyen").innerHTML = kayitlar.filter(k=>!k.satildi).map(k=>`
        <div class="list-item">
            <div><strong>${k.urun}</strong><br><small style="color:#888">${k.gram} gr - ${formatPara(k.tutar)} ‚Ç∫</small></div>
            <div>
                <button class="btn-sat" onclick="islemYap(${k.id}, 'sat')">SAT</button>
                <button class="btn-sil" onclick="islemYap(${k.id}, 'sil')">Sƒ∞L</button>
            </div>
        </div>`).join('');
}

function islemYap(id, tip){
    let idx = kayitlar.findIndex(k=>k.id === id);
    if(tip === 'sat') kayitlar[idx].satildi = true;
    else if(confirm("ƒ∞≈ülem silinsin mi?")) kayitlar.splice(idx, 1);
    save(); renderRapor();
}

function renderAyar(){
    document.getElementById("ayarList").innerHTML = urunler.map((u,i)=>`
        <div class="list-item">
            <div><strong>${u.ad}</strong><br><small style="color:#888">${u.fiyat} ‚Ç∫</small></div>
            <div>
                <button class="btn-sat" style="background:#444" onclick="editMode(${i})">D√úZENLE</button>
                <button class="btn-sil" onclick="urunSil(${i})">Sƒ∞L</button>
            </div>
        </div>`).join('');
}

function editMode(i) {
    editIndex = i;
    document.getElementById("urunAd").value = urunler[i].ad;
    document.getElementById("urunFiyat").value = urunler[i].fiyat;
    document.getElementById("ayarTitle").innerText = "√úR√úN√ú D√úZENLE";
    document.getElementById("saveBtn").innerText = "G√úNCELLEMEYƒ∞ KAYDET";
    document.getElementById("cancelEdit").style.display = "block";
}

function resetEdit() {
    editIndex = -1;
    document.getElementById("urunAd").value = "";
    document.getElementById("urunFiyat").value = "";
    document.getElementById("ayarTitle").innerText = "√úR√úN EKLE / D√úZENLE";
    document.getElementById("saveBtn").innerText = "Sƒ∞STEME KAYDET";
    document.getElementById("cancelEdit").style.display = "none";
}

function urunEkle(){
    let ad = document.getElementById("urunAd").value, f = parseFloat(document.getElementById("urunFiyat").value);
    if(!ad || !f) return;
    if(editIndex > -1) urunler[editIndex] = {ad, fiyat:f};
    else urunler.push({ad, fiyat:f});
    save(); renderUrunler(); renderAyar(); resetEdit();
}

function urunSil(i){ if(confirm("√úr√ºn silinsin mi?")){ urunler.splice(i, 1); save(); renderAyar(); renderUrunler(); } }
function saveWp() { localStorage.setItem("wpTel", document.getElementById("wpTel").value); }
function loadWp() { document.getElementById("wpTel").value = localStorage.getItem("wpTel") || ""; }

function gunSonu(){
    let satilanlar = kayitlar.filter(x=>x.satildi);
    if(!satilanlar.length) return alert("Kapatƒ±lacak satƒ±≈ü bulunamadƒ±!");
    let d = new Date(), t = d.toLocaleDateString('tr-TR'), ciro = satilanlar.reduce((s,i)=>s+i.tutar, 0);
    let key = "arsiv_" + d.getFullYear() + String(d.getMonth()+1).padStart(2,'0') + String(d.getDate()).padStart(2,'0') + "_" + d.getTime();
    localStorage.setItem(key, JSON.stringify({ label: t, data: satilanlar }));

    let msg = `üì± *EMRE G√úM√ú≈û RAPOR*\nüí∞ *Ciro:* ${formatPara(ciro)} ‚Ç∫\n------------------\n`;
    satilanlar.forEach(s=> msg += `- ${s.urun}: ${s.gram}gr\n`);
    
    let tel = localStorage.getItem("wpTel");
    if(tel && confirm("WhatsApp raporu g√∂nderilsin mi?")) window.open(`https://api.whatsapp.com/send?phone=${tel}&text=${encodeURIComponent(msg)}`, '_blank');

    kayitlar = kayitlar.filter(x=>!x.satildi);
    save(); renderRapor(); renderArsiv(); renderChart();
}

function renderChart() {
    const ctx = document.getElementById('ciroChart').getContext('2d');
    const keys = Object.keys(localStorage).filter(k=>k.startsWith("arsiv_")).sort().slice(-7);
    let labels = [], data = [];
    keys.forEach(k => {
        let obj = JSON.parse(localStorage.getItem(k));
        labels.push(obj.label);
        data.push((obj.data || []).reduce((s, i) => s + i.tutar, 0));
    });
    if(myChart) myChart.destroy();
    myChart = new Chart(ctx, { type: 'bar', data: { labels, datasets: [{ label: 'Ciro', data, backgroundColor: '#D4AF37', borderRadius: 8 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, grid: { color: '#222' } } } } });
}

function renderArsiv(){
    const keys = Object.keys(localStorage).filter(k=>k.startsWith("arsiv_")).sort().reverse();
    document.getElementById("arsivList").innerHTML = keys.map(k=> {
        let obj = JSON.parse(localStorage.getItem(k));
        return `<div class="list-item"><span>üìÇ ${obj.label}</span><button class="btn-sil" onclick="localStorage.removeItem('${k}');renderArsiv();">Sƒ∞L</button></div>`;
    }).join('');
}

function save(){ localStorage.setItem("kayitlar", JSON.stringify(kayitlar)); localStorage.setItem("urunler", JSON.stringify(urunler)); }
function formatPara(n){ return n.toLocaleString('tr-TR',{minimumFractionDigits:2}); }
</script>
</body>
</html>
